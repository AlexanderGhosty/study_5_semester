# Лабораторная работа №8 - FastAPI приложение

## Описание

Лабораторная работа по изучению FastAPI - современного веб-фреймворка для создания API на Python. Демонстрирует основные возможности FastAPI: работу с параметрами, JSON, файлами, авторизацией и JWT токенами.

## Структура проекта

```
l8/
├── app/
│   ├── __init__.py      # Инициализация пакета
│   ├── main.py          # Основное FastAPI приложение
│   ├── models.py        # Pydantic модели для валидации данных
│   ├── storage.py       # Хранилище пользователей в памяти
│   └── auth.py          # JWT авторизация и аутентификация
├── sample.txt           # Тестовый файл для загрузки
└── README.md           # Документация (этот файл)
```

## Функциональность

### 1. Базовое API (`main.py`)
- Приветственное сообщение на корневом маршруте
- Параметры пути и запроса
- Валидация данных с помощью Pydantic

### 2. Работа с параметрами
- **Path параметры**: извлечение значений из URL
- **Query параметры**: обработка параметров запроса
- **Form данные**: обработка HTML форм
- **JSON payload**: работа со структурированными данными

### 3. Обработка файлов
- Загрузка файлов через multipart/form-data
- Валидация типов файлов
- Сохранение и обработка загруженных файлов
- Скачивание файлов

### 4. Аутентификация и авторизация (`auth.py`)
- JWT токены для авторизации
- Регистрация новых пользователей
- Вход в систему с проверкой учетных данных
- Защищенные маршруты

### 5. Модели данных (`models.py`)
- **User**: модель пользователя с валидацией
- **RegisterPayload**: данные для регистрации
- Автоматическая валидация и документация API

### 6. Хранилище данных (`storage.py`)
- In-memory хранилище пользователей
- CRUD операции для пользователей
- Генерация уникальных ID

## Запуск

### Установка зависимостей
```bash
pip install fastapi uvicorn python-multipart python-jose[cryptography] passlib[bcrypt]
```

### Запуск сервера
```bash
# Из корня проекта
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### Альтернативный запуск
```bash
# Из директории l8
python -m uvicorn app.main:app --reload
```

## Использование API

### Базовые маршруты
- `GET /` - приветственное сообщение
- `GET /greet/{name}` - персональное приветствие
- `GET /search` - поиск с параметрами запроса

### Аутентификация
- `POST /register` - регистрация нового пользователя
- `POST /login` - вход в систему
- `GET /profile` - получение профиля (требует авторизации)

### Работа с файлами
- `POST /upload` - загрузка файла
- `GET /download` - скачивание файла

## Пример использования

### Регистрация пользователя
```bash
curl -X POST "http://localhost:8000/register" \
     -H "Content-Type: application/json" \
     -d '{
       "username": "testuser",
       "email": "test@example.com",
       "password": "testpass"
     }'
```

### Вход в систему
```bash
curl -X POST "http://localhost:8000/login" \
     -H "Content-Type: application/x-www-form-urlencoded" \
     -d "username=testuser&password=testpass"
```

### Доступ к защищенному маршруту
```bash
curl -X GET "http://localhost:8000/profile" \
     -H "Authorization: Bearer YOUR_JWT_TOKEN"
```

### Загрузка файла
```bash
curl -X POST "http://localhost:8000/upload" \
     -F "file=@sample.txt"
```

## Интерактивная документация

После запуска сервера доступна автоматически генерируемая документация:

- **Swagger UI**: http://localhost:8000/docs
- **ReDoc**: http://localhost:8000/redoc

## Особенности реализации

- Использование современных Python типов с аннотациями
- Автоматическая валидация входных данных
- Генерация OpenAPI схемы
- Асинхронная обработка запросов
- JWT для безопасной авторизации
- Обработка ошибок с информативными сообщениями

## Цель работы

Изучение современного подхода к созданию веб-API с использованием FastAPI. Освоение работы с HTTP-запросами, валидацией данных, аутентификацией и авторизацией в веб-приложениях.